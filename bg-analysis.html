<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backgammon Move Analyzer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .board-container {
            flex: 2;
            min-width: 600px;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .controls {
            flex: 1;
            min-width: 300px;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .board {
            width: 600px;
            height: 400px;
            background-color: #e6c88c;
            position: relative;
            margin: 0 auto;
        }
        .point {
            position: absolute;
            width: 24px;
            height: 160px;
            background-color: transparent;
        }
        .checker {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 1px solid #333;
        }
        .white {
            background-color: white;
        }
        .black {
            background-color: black;
        }
        .dice-container {
            text-align: center;
            margin: 20px 0;
        }
        .dice {
            display: inline-block;
            width: 40px;
            height: 40px;
            background-color: white;
            border: 1px solid #333;
            border-radius: 5px;
            text-align: center;
            line-height: 40px;
            font-size: 20px;
            margin: 5px;
        }
        .dice-input {
            width: 40px;
            height: 40px;
            text-align: center;
            font-size: 20px;
            margin: 5px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .move-suggestion {
            background-color: #e6f7ff;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #1890ff;
        }
        .game-log {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            margin-top: 20px;
            background-color: #f9f9f9;
        }
        .player-turn {
            text-align: center;
            font-weight: bold;
            margin: 10px 0;
            padding: 5px;
            background-color: #e6f7ff;
            border-radius: 5px;
        }
        .bar {
            position: absolute;
            left: 290px;
            width: 20px;
            height: 400px;
            background-color: #8b4513;
        }
    </style>
</head>
<body>
    <h1>Backgammon Move Analyzer</h1>
    
    <div class="container">
        <div class="board-container">
            <h2>Current Board Position</h2>
            <div class="board" id="board">
                <div class="bar"></div>
                <!-- Points will be generated by JavaScript -->
            </div>
            <div class="player-turn" id="player-turn">
                White's turn - Roll the dice
            </div>
            <div class="dice-container">
                <h3>Dice Roll: </h3>
                <input type="number" min="1" max="6" class="dice-input" id="dice1-input">
                <input type="number" min="1" max="6" class="dice-input" id="dice2-input">
                <button id="submit-roll-btn">Submit Roll</button>
                <button id="suggest-move-btn">Suggest Best Move</button>
            </div>
        </div>
        
        <div class="controls">
            <h2>Move Analysis</h2>
            
            <div id="move-suggestions">
                <p>Roll the dice to get move suggestions.</p>
            </div>
            
            <div class="game-log" id="game-log">
                <h3>Game Log</h3>
                <p>Game started. White to play first.</p>
            </div>
            
            <div class="controls">
                <button id="new-game-btn">New Game</button>
                <button id="undo-move-btn">Undo Last Move</button>
            </div>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            currentPlayer: 'white',
            dice: [0, 0],
            moves: [],
            position: initializeStartingPosition()
        };

        // Initialize the board
        document.addEventListener('DOMContentLoaded', function() {
            const board = document.getElementById('board');
            
            // Create points (24 points in backgammon)
            for (let i = 0; i < 24; i++) {
                const point = document.createElement('div');
                point.className = 'point';
                point.id = 'point-' + (i+1);
                
                // Position points alternately on top and bottom
                const isTop = i < 12;
                const row = Math.floor(i / 6);
                const col = i % 6;
                
                const left = i < 12 ? 50 + col * 90 : 50 + (5 - col) * 90;
                const top = isTop ? 20 : 220;
                
                point.style.left = left + 'px';
                point.style.top = top + 'px';
                
                // Add triangle shape using CSS
                point.style.clipPath = isTop 
                    ? 'polygon(0% 0%, 100% 0%, 50% 100%)'
                    : 'polygon(0% 100%, 100% 100%, 50% 0%)';
                point.style.backgroundColor = row % 2 === 0 ? '#8b4513' : '#f5deb3';
                
                board.appendChild(point);
            }
            
            // Initialize starting position
            updateBoard();
            
            // Set up event listeners
            document.getElementById('submit-roll-btn').addEventListener('click', submitRoll);
            document.getElementById('suggest-move-btn').addEventListener('click', suggestBestMove);
            document.getElementById('new-game-btn').addEventListener('click', newGame);
            document.getElementById('undo-move-btn').addEventListener('click', undoLastMove);
        });
        
        function initializeStartingPosition() {
            return {
                1: {count: 2, color: 'black'},
                6: {count: 5, color: 'white'},
                8: {count: 3, color: 'white'},
                12: {count: 5, color: 'black'},
                13: {count: 5, color: 'white'},
                17: {count: 3, color: 'black'},
                19: {count: 5, color: 'black'},
                24: {count: 2, color: 'white'},
                bar: {white: 0, black: 0},
                off: {white: 0, black: 0}
            };
        }
        
        function updateBoard() {
            // Clear all checkers
            const checkers = document.querySelectorAll('.checker');
            checkers.forEach(c => c.remove());
            
            // Update points
            for (let i = 1; i <= 24; i++) {
                const point = document.getElementById('point-' + i);
                if (gameState.position[i]) {
                    const {count, color} = gameState.position[i];
                    const isTop = i <= 12;
                    
                    for (let j = 0; j < count; j++) {
                        const checker = document.createElement('div');
                        checker.className = 'checker ' + color;
                        
                        // Position checkers on the point
                        const left = parseInt(point.style.left) + 2;
                        const top = parseInt(point.style.top) + (isTop ? j * 10 : -j * 10);
                        
                        checker.style.left = left + 'px';
                        checker.style.top = top + 'px';
                        
                        point.appendChild(checker);
                    }
                }
            }
            
            // Update bar
            const bar = document.querySelector('.bar');
            for (let i = 0; i < gameState.position.bar.white; i++) {
                const checker = document.createElement('div');
                checker.className = 'checker white';
                checker.style.left = '295px';
                checker.style.top = (200 + i * 20) + 'px';
                bar.appendChild(checker);
            }
            for (let i = 0; i < gameState.position.bar.black; i++) {
                const checker = document.createElement('div');
                checker.className = 'checker black';
                checker.style.left = '295px';
                checker.style.top = (100 + i * 20) + 'px';
                bar.appendChild(checker);
            }
            
            // Update player turn display
            document.getElementById('player-turn').textContent = 
                `${gameState.currentPlayer === 'white' ? 'White' : 'Black'}'s turn - ${gameState.dice[0] ? 'Choose move' : 'Roll the dice'}`;
        }
        
        function submitRoll() {
            const die1 = parseInt(document.getElementById('dice1-input').value);
            const die2 = parseInt(document.getElementById('dice2-input').value);
            
            if (isNaN(die1) || isNaN(die2) {
                alert('Please enter valid dice values (1-6)');
                return;
            }
            
            gameState.dice = [die1, die2];
            document.getElementById('player-turn').textContent = 
                `${gameState.currentPlayer === 'white' ? 'White' : 'Black'}'s turn - Choose move`;
            
            logToGame(`Player rolled ${die1}-${die2}`);
            
            // Auto-suggest moves
            suggestBestMove();
        }
        
        function suggestBestMove() {
            if (gameState.dice[0] === 0) {
                alert('Please roll the dice first');
                return;
            }
            
            const [die1, die2] = gameState.dice;
            const player = gameState.currentPlayer;
            
            // In a real implementation, this would use a backgammon AI
            // For this demo, we'll provide sample suggestions based on position
            
            const suggestions = document.getElementById('move-suggestions');
            
            // Get sample moves based on dice and player
            const bestMove = getBestMoveSample(die1, die2, player);
            const altMove = getAlternativeMoveSample(die1, die2, player);
            
            suggestions.innerHTML = `
                <h3>Suggested Moves for ${die1}-${die2}</h3>
                <div class="move-suggestion">
                    <strong>1. ${bestMove}</strong> (Best equity)
                    <p>${getMoveExplanation(bestMove, player)}</p>
                </div>
                <div class="move-suggestion">
                    <strong>2. ${altMove}</strong> (Alternative)
                    <p>${getMoveExplanation(altMove, player)}</p>
                </div>
                <p><em>Click on a move to play it</em></p>
            `;
            
            // Add click handlers to suggested moves
            document.querySelectorAll('.move-suggestion').forEach((el, index) => {
                el.style.cursor = 'pointer';
                el.addEventListener('click', () => {
                    const move = index === 0 ? bestMove : altMove;
                    playMove(move);
                });
            });
        }
        
        function getBestMoveSample(die1, die2, player) {
            // This is just sample logic - a real AI would be much more sophisticated
            const isWhite = player === 'white';
            
            // Sample moves for different dice combinations
            if (die1 === 6 && die2 === 6) {
                return isWhite ? "24/18 24/18" : "1/7 1/7";
            }
            if (die1 === 5 && die2 === 5) {
                return isWhite ? "13/8 13/8" : "12/17 12/17";
            }
            if (die1 === 4 && die2 === 4) {
                return isWhite ? "8/4 8/4" : "17/21 17/21";
            }
            
            // For other rolls, combine the dice in different ways
            const moves = [
                `13/${13-die1} 6/${6-die2}`,
                `8/${8-die1} 6/${6-die2}`,
                `24/${24-die1} 13/${13-die2}`,
                `19/${19-die1} 17/${17-die2}`
            ];
            
            return moves[(die1 + die2) % moves.length];
        }
        
        function getAlternativeMoveSample(die1, die2, player) {
            // Alternative moves that are slightly less optimal
            const isWhite = player === 'white';
            
            if (die1 === 6 && die2 === 6) {
                return isWhite ? "24/18 13/7" : "1/7 6/12";
            }
            if (die1 === 5 && die2 === 5) {
                return isWhite ? "13/8 6/1" : "12/17 19/24";
            }
            
            const moves = [
                `8/${8-die1} 13/${13-die2}`,
                `6/${6-die1} 13/${13-die2}`,
                `24/${24-die1} 8/${8-die2}`,
                `19/${19-die1} 13/${13-die2}`
            ];
            
            return moves[(die1 * die2) % moves.length];
        }
        
        function getMoveExplanation(move, player) {
            // Sample explanations for different types of moves
            if (move.includes("24/")) {
                return "Brings your back checkers into play, which is important in the early game.";
            }
            if (move.includes("13/") || move.includes("8/")) {
                return "Develops your position by moving builders toward your home board.";
            }
            if (move.includes("6/")) {
                return "Strengthens your home board, making it harder for opponent to enter if hit.";
            }
            return "Good standard move that balances development and safety.";
        }
        
        function playMove(move) {
            // In a real implementation, this would validate and apply the move
            // For this demo, we'll just log it and switch players
            
            logToGame(`Player played ${move}`);
            
            // Switch player
            gameState.currentPlayer = gameState.currentPlayer === 'white' ? 'black' : 'white';
            gameState.dice = [0, 0];
            document.getElementById('dice1-input').value = '';
            document.getElementById('dice2-input').value = '';
            
            updateBoard();
        }
        
        function logToGame(message) {
            const log = document.getElementById('game-log');
            log.innerHTML += `<p>${message}</p>`;
            log.scrollTop = log.scrollHeight;
        }
        
        function newGame() {
            gameState.currentPlayer = 'white';
            gameState.dice = [0, 0];
            gameState.moves = [];
            gameState.position = initializeStartingPosition();
            
            document.getElementById('dice1-input').value = '';
            document.getElementById('dice2-input').value = '';
            document.getElementById('move-suggestions').innerHTML = '<p>Roll the dice to get move suggestions.</p>';
            document.getElementById('game-log').innerHTML = '<h3>Game Log</h3><p>New game started. White to play first.</p>';
            
            updateBoard();
        }
        
        function undoLastMove() {
            if (gameState.moves.length === 0) {
                alert('No moves to undo');
                return;
            }
            
            // In a real implementation, this would revert the last move
            // For this demo, we'll just remove the last log entry
            const log = document.getElementById('game-log');
            const entries = log.querySelectorAll('p');
            if (entries.length > 1) {
                entries[entries.length - 1].remove();
            }
            
            // Reset dice if this was the current player's roll
            if (gameState.dice[0] !== 0) {
                gameState.dice = [0, 0];
                document.getElementById('dice1-input').value = '';
                document.getElementById('dice2-input').value = '';
            } else {
                // Otherwise switch back to previous player
                gameState.currentPlayer = gameState.currentPlayer === 'white' ? 'black' : 'white';
            }
            
            updateBoard();
        }
    </script>
</body>
</html>
